# Настройка Yandex Maps API ключа на Vercel

## Проблема
Получаете ошибку 403 при обращении к `/api/yandex` - это означает, что API ключ Yandex Maps не настроен на Vercel.

## Решение

### 1. Получите API ключ Yandex Maps

1. Перейдите на [Yandex Developer Console](https://developer.tech.yandex.ru/)
2. Войдите в аккаунт или создайте новый
3. Создайте новый проект или выберите существующий
4. В разделе "API" включите:
   - **JavaScript API и HTTP Геокодер** - для карт
   - **Поиск по организациям** - для подсказок адресов
5. Скопируйте API ключ (выглядит примерно так: `a1b2c3d4-e5f6-7890-abcd-ef1234567890`)

### 2. Настройте переменную окружения на Vercel

#### Через веб-интерфейс Vercel:
1. Перейдите в ваш проект на [vercel.com](https://vercel.com)
2. Откройте вкладку **Settings**
3. В левом меню выберите **Environment Variables**
4. Нажмите **Add New**
5. Заполните:
   - **Name**: `YANDEX_MAPS_API_KEY`
   - **Value**: ваш API ключ от Yandex
   - **Environment**: выберите все (Production, Preview, Development)
6. Нажмите **Save**

#### Через Vercel CLI:
```bash
vercel env add YANDEX_MAPS_API_KEY
# Введите ваш API ключ когда попросит
```

### 3. Переразверните проект

После добавления переменной окружения:
1. Перейдите в раздел **Deployments**
2. Нажмите **Redeploy** на последнем деплое
3. Или сделайте новый коммит в GitHub - Vercel автоматически переразвернет

### 4. Проверьте настройку

После развертывания проверьте:
1. Откройте `https://your-domain.vercel.app/api/check-env`
2. Убедитесь, что `yandexApiKeyConfigured: true`
3. Попробуйте автокомплит адресов на сайте

## Проверка работы

### Тестовый запрос:
```
GET https://your-domain.vercel.app/api/yandex?action=suggest&text=площадь&type=address&lang=ru_RU&results=5
```

### Ожидаемый ответ:
```json
{
  "results": [
    {
      "title": "Площадь Ленина",
      "subtitle": "Саратов, Саратовская область"
    }
  ],
  "originalCount": 10,
  "filteredCount": 1
}
```

## Возможные проблемы

### 1. API ключ не работает
- Убедитесь, что включены нужные API в Yandex Developer Console
- Проверьте, что API ключ скопирован полностью
- Убедитесь, что проект не заблокирован в Yandex

### 2. Переменная окружения не применилась
- Переразверните проект после добавления переменной
- Проверьте, что переменная добавлена для всех окружений (Production, Preview, Development)

### 3. Ошибка 403 все еще появляется
- Проверьте логи Vercel в разделе Functions
- Убедитесь, что API ключ правильный
- Попробуйте создать новый API ключ в Yandex

## Безопасность

- ✅ API ключ хранится только на сервере Vercel
- ✅ Клиентская часть не имеет доступа к API ключу
- ✅ Все запросы проходят через ваш сервер
