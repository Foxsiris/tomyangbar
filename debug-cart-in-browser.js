// –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã –≤ –±—Ä–∞—É–∑–µ—Ä–µ
// –í—ã–ø–æ–ª–Ω–∏—Ç–µ —ç—Ç–æ—Ç –∫–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

console.log('üîç –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç–ª–∞–¥–∫—É –∫–æ—Ä–∑–∏–Ω—ã...');

// 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ Supabase –ø–æ–¥–∫–ª—é—á–µ–Ω
console.log('1. –ü—Ä–æ–≤–µ—Ä—è–µ–º Supabase...');
if (typeof window.supabase !== 'undefined') {
  console.log('‚úÖ Supabase –¥–æ—Å—Ç—É–ø–µ–Ω');
} else {
  console.log('‚ùå Supabase –Ω–µ –Ω–∞–π–¥–µ–Ω');
}

// 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage
console.log('2. –ü—Ä–æ–≤–µ—Ä—è–µ–º localStorage...');
const sessionId = localStorage.getItem('cart_session_id');
console.log('Session ID:', sessionId);

// 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∑–∏–Ω—ã
console.log('3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ—Ä–∑–∏–Ω—ã...');
if (typeof window.React !== 'undefined') {
  console.log('‚úÖ React –¥–æ—Å—Ç—É–ø–µ–Ω');
} else {
  console.log('‚ùå React –Ω–µ –Ω–∞–π–¥–µ–Ω');
}

// 4. –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ Supabase
console.log('4. –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ Supabase...');

// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º Supabase (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
if (typeof window.supabase !== 'undefined') {
  const { supabase } = window.supabase;
  
  // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
  supabase.from('carts').select('count').limit(1)
    .then(({ data, error }) => {
      if (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase:', error);
      } else {
        console.log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Supabase —Ä–∞–±–æ—Ç–∞–µ—Ç');
        
        // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã
        const testSessionId = 'test_' + Date.now();
        console.log('5. –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ—Ä–∑–∏–Ω—ã...');
        
        supabase.from('carts').insert([{
          session_id: testSessionId
        }]).select().single()
          .then(({ data: cart, error: cartError }) => {
            if (cartError) {
              console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ—Ä–∑–∏–Ω—ã:', cartError);
            } else {
              console.log('‚úÖ –ö–æ—Ä–∑–∏–Ω–∞ —Å–æ–∑–¥–∞–Ω–∞:', cart);
              
              // –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
              console.log('6. –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞...');
              
              // –°–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ–º –±–ª—é–¥–æ
              supabase.from('dishes').select('*').limit(1).single()
                .then(({ data: dish, error: dishError }) => {
                  if (dishError) {
                    console.error('‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –±–ª—é–¥–∞:', dishError);
                  } else {
                    console.log('‚úÖ –ë–ª—é–¥–æ –ø–æ–ª—É—á–µ–Ω–æ:', dish);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ—Ä–∑–∏–Ω—É
                    supabase.from('cart_items').insert([{
                      cart_id: cart.id,
                      dish_id: dish.id,
                      dish_name: dish.name,
                      quantity: 1,
                      price: dish.price
                    }]).select().single()
                      .then(({ data: item, error: itemError }) => {
                        if (itemError) {
                          console.error('‚ùå –û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞:', itemError);
                        } else {
                          console.log('‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É:', item);
                          console.log('üéâ –¢–µ—Å—Ç –∫–æ—Ä–∑–∏–Ω—ã –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ!');
                        }
                      });
                  }
                });
            }
          });
      }
    });
} else {
  console.log('‚ùå Supabase –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –≤ window –æ–±—ä–µ–∫—Ç–µ');
}

// 5. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
console.log('5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫...');
