# Настройка Yandex Maps API

## Проблема CORS

Yandex Maps API не позволяет делать запросы напрямую с клиентской стороны из-за CORS политики. Для решения этой проблемы созданы API endpoints на сервере.

## Созданные API endpoints

### 1. `/api/yandex/suggest` - Подсказки адресов
- **Метод**: GET
- **Параметры**: 
  - `text` - текст для поиска (обязательный)
  - `type` - тип поиска (по умолчанию: address)
  - `lang` - язык (по умолчанию: ru_RU)
  - `results` - количество результатов (по умолчанию: 10)

**Пример запроса:**
```
GET /api/yandex/suggest?text=площадь&type=address&lang=ru_RU&results=10
```

### 2. `/api/yandex/geocode` - Геокодирование адреса
- **Метод**: GET
- **Параметры**:
  - `address` - адрес для геокодирования (обязательный)

**Пример запроса:**
```
GET /api/yandex/geocode?address=Саратов, площадь Ленина, 1
```

## Настройка переменных окружения

### Для Vercel/Netlify:
1. Перейдите в настройки проекта
2. Добавьте переменную окружения:
   - **Имя**: `YANDEX_MAPS_API_KEY`
   - **Значение**: ваш API ключ от Yandex Maps

### Для локальной разработки:
Создайте файл `.env.local` в корне проекта:
```
YANDEX_MAPS_API_KEY=ваш_api_ключ_здесь
```

## Получение API ключа

1. Перейдите на [Yandex Developer Console](https://developer.tech.yandex.ru/)
2. Создайте новый проект или выберите существующий
3. Включите API:
   - **JavaScript API и HTTP Геокодер** - для карт
   - **Поиск по организациям** - для подсказок адресов
4. Скопируйте API ключ

## Обновленные компоненты

### AddressAutocomplete.jsx
- Теперь использует `/api/yandex/suggest` вместо прямого обращения к Yandex API
- Автоматически определяет URL для разработки и продакшена
- Фильтрует результаты только по Саратову

### YandexMap.jsx
- Может использовать `/api/yandex/geocode` для геокодирования адресов
- Сохранена поддержка прямого использования Yandex Maps API для отображения карт

## Тестирование

1. Убедитесь, что API ключ настроен
2. Запустите проект: `npm run dev`
3. Перейдите на страницу с картой
4. Попробуйте ввести адрес в поле автокомплита
5. Проверьте, что подсказки загружаются без ошибок CORS

## Развертывание

При развертывании на Vercel/Netlify:
1. Убедитесь, что переменная `YANDEX_MAPS_API_KEY` настроена
2. API endpoints будут доступны по адресам:
   - `https://your-domain.vercel.app/api/yandex/suggest`
   - `https://your-domain.vercel.app/api/yandex/geocode`

## Безопасность

- API ключ хранится только на сервере
- Клиентская часть не имеет прямого доступа к API ключу
- Все запросы проходят через ваш сервер, что обеспечивает контроль доступа
