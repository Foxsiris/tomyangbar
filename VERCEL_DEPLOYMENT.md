# Развертывание Tom Yang Bar на Vercel с Supabase

## Подготовка к развертыванию

### 1. Настройка переменных окружения в Vercel

В настройках проекта Vercel добавьте следующие переменные окружения:

```env
VITE_SUPABASE_URL=https://fguwtuaxtjrojgjnxchv.supabase.co
VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZndXd0dWF4dGpyb2pnam54Y2h2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgwNDg0ODUsImV4cCI6MjA3MzYyNDQ4NX0.-NyA5IJkBuYG-qMABFNQ5KFw38q8RHdg182Eswwddlw
```

### 2. Настройка Supabase

1. Выполните SQL схему из файла `supabase-schema.sql` в SQL Editor Supabase
2. Убедитесь, что RLS политики активны
3. Проверьте, что тестовые данные созданы

### 3. Настройка домена

Vercel автоматически предоставляет домен вида `your-project.vercel.app`. 
Для RU доменов можно:
- Использовать домен Vercel (работает без ограничений)
- Подключить собственный домен через настройки Vercel

## Команды для развертывания

### Автоматическое развертывание (рекомендуется)

1. Подключите репозиторий к Vercel
2. Vercel автоматически определит настройки сборки
3. Добавьте переменные окружения в настройках проекта

### Ручное развертывание

```bash
# Установка Vercel CLI
npm i -g vercel

# Логин в Vercel
vercel login

# Развертывание
vercel

# Продакшен развертывание
vercel --prod
```

## Настройки сборки Vercel

Vercel автоматически определит настройки для React/Vite проекта:

- **Build Command**: `npm run build`
- **Output Directory**: `dist`
- **Install Command**: `npm install`

## Проверка после развертывания

### 1. Основной функционал
- [ ] Загрузка главной страницы
- [ ] Просмотр меню
- [ ] Добавление товаров в корзину
- [ ] Регистрация пользователя
- [ ] Авторизация пользователя
- [ ] Создание заказа
- [ ] Просмотр профиля

### 2. Админ-панель
- [ ] Доступ к админ-панели
- [ ] Просмотр заказов
- [ ] Обновление статусов заказов
- [ ] Статистика

### 3. База данных
- [ ] Создание пользователей в Supabase
- [ ] Создание заказов в Supabase
- [ ] Синхронизация корзин

## Возможные проблемы и решения

### 1. Ошибки CORS
Supabase автоматически настраивает CORS для всех доменов. Если возникают проблемы:
- Проверьте настройки в Supabase Dashboard → Settings → API
- Убедитесь, что домен добавлен в список разрешенных

### 2. Ошибки аутентификации
- Проверьте правильность API ключей
- Убедитесь, что RLS политики настроены корректно
- Проверьте логи в Supabase Dashboard

### 3. Проблемы с переменными окружения
- Убедитесь, что переменные добавлены в Vercel
- Проверьте, что переменные начинаются с `VITE_`
- Пересоберите проект после изменения переменных

## Мониторинг

### Vercel Analytics
- Включите Vercel Analytics для отслеживания производительности
- Мониторьте ошибки в Vercel Dashboard

### Supabase Monitoring
- Отслеживайте использование базы данных
- Мониторьте API запросы
- Проверяйте логи ошибок

## Безопасность

### 1. API ключи
- Никогда не коммитьте API ключи в репозиторий
- Используйте переменные окружения
- Регулярно ротируйте ключи

### 2. RLS политики
- Убедитесь, что RLS включен для всех таблиц
- Регулярно проверяйте политики безопасности
- Тестируйте доступы с разных ролей

### 3. HTTPS
- Vercel автоматически предоставляет HTTPS
- Убедитесь, что все запросы идут по HTTPS

## Производительность

### 1. Оптимизация изображений
- Используйте Vercel Image Optimization
- Оптимизируйте размеры изображений

### 2. Кэширование
- Настройте кэширование статических ресурсов
- Используйте Supabase кэширование для запросов

### 3. CDN
- Vercel автоматически использует глобальную CDN
- Проверьте скорость загрузки в разных регионах

## Резервное копирование

### 1. База данных
- Настройте автоматические бэкапы в Supabase
- Регулярно экспортируйте данные

### 2. Код
- Используйте Git для версионирования
- Настройте автоматические деплои из main ветки

## Поддержка

При возникновении проблем:
1. Проверьте логи в Vercel Dashboard
2. Проверьте логи в Supabase Dashboard
3. Обратитесь к документации Vercel и Supabase
4. Проверьте статус сервисов
